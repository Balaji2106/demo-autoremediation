# =============================================================================
# AIOps RCA Assistant - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your actual values
# cp .env.example .env

# -----------------------------------------------------------------------------
# Required: API Keys and Authentication
# -----------------------------------------------------------------------------
RCA_API_KEY=your-secret-api-key-here
GEMINI_API_KEY=your-google-gemini-api-key
JWT_SECRET_KEY=your-jwt-secret-key-for-auth

# -----------------------------------------------------------------------------
# CRITICAL: Databricks API Credentials (Required for error extraction)
# -----------------------------------------------------------------------------
# Without these, the system will only receive generic "job failed" messages
# from webhooks and cannot fetch detailed error information

# Your Databricks workspace URL (find in Azure Portal → Databricks → Overview → URL)
# Example: https://adb-1234567890123456.7.azuredatabricks.net
DATABRICKS_HOST=https://your-databricks-workspace-url.azuredatabricks.net

# Databricks Personal Access Token (generate in Databricks → User Settings → Access Tokens)
# How to generate:
#   1. Go to Databricks workspace
#   2. Click your profile (top right) → User Settings
#   3. Go to Access Tokens tab
#   4. Click "Generate New Token"
#   5. Give it a name like "RCA System" and lifetime (90-365 days)
#   6. Copy the token (it won't be shown again)
DATABRICKS_TOKEN=dapi1234567890abcdef...

# -----------------------------------------------------------------------------
# Optional: Slack Integration
# -----------------------------------------------------------------------------
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_ALERT_CHANNEL=aiops-rca-alerts

# -----------------------------------------------------------------------------
# Optional: ITSM Integration (Jira)
# -----------------------------------------------------------------------------
ITSM_TOOL=jira  # Options: none, jira
JIRA_DOMAIN=https://your-company.atlassian.net
JIRA_USER_EMAIL=your-email@company.com
JIRA_API_TOKEN=your-jira-api-token
JIRA_PROJECT_KEY=AIOPS
JIRA_WEBHOOK_SECRET=your-webhook-secret

# -----------------------------------------------------------------------------
# Optional: Azure SQL Database (default: SQLite)
# -----------------------------------------------------------------------------
DB_TYPE=sqlite  # Options: sqlite, azuresql
DB_PATH=data/tickets.db  # Only used if DB_TYPE=sqlite

# Azure SQL configuration (only if DB_TYPE=azuresql)
# AZURE_SQL_SERVER=your-server.database.windows.net
# AZURE_SQL_DATABASE=rca_tickets
# AZURE_SQL_USERNAME=sqladmin
# AZURE_SQL_PASSWORD=your-password

# -----------------------------------------------------------------------------
# Optional: Azure Blob Storage (for audit logs)
# -----------------------------------------------------------------------------
AZURE_BLOB_ENABLED=false
AZURE_STORAGE_CONN=DefaultEndpointsProtocol=https;AccountName=...
AZURE_BLOB_CONTAINER_NAME=audit-logs

# -----------------------------------------------------------------------------
# Optional: AI Provider Selection (Gemini, Azure OpenAI, or Ollama)
# -----------------------------------------------------------------------------
AI_PROVIDER=gemini  # Options: gemini, azure_openai, ollama

# Google Gemini Configuration (default)
GEMINI_API_KEY=your-google-gemini-api-key
MODEL_ID=models/gemini-2.5-flash

# Azure OpenAI Configuration (if AI_PROVIDER=azure_openai)
AZURE_OPENAI_API_KEY=your-azure-openai-api-key
AZURE_OPENAI_ENDPOINT=https://your-endpoint.cognitiveservices.azure.com/
AZURE_OPENAI_DEPLOYMENT=gpt-4  # or gpt-4o, gpt-35-turbo
RAG_AZURE_OPENAI_API_VERSION=2024-12-01-preview

# Ollama Configuration (if AI_PROVIDER=ollama - self-hosted)
OLLAMA_HOST=http://localhost:11434
OLLAMA_MODEL=deepseek-r1:latest  # or llama3, mistral, etc.

# -----------------------------------------------------------------------------
# Optional: Auto-Remediation System
# -----------------------------------------------------------------------------
AUTO_REMEDIATION_ENABLED=false  # Set to true to enable automated recovery

# Azure Credentials for Auto-Remediation (required for ADF playbooks)
AZURE_SUBSCRIPTION_ID=your-subscription-id
AZURE_RESOURCE_GROUP=your-resource-group
AZURE_ADF_NAME=your-adf-name
AZURE_ACCESS_TOKEN=your-access-token  # Or use Azure CLI token

# Auto-Remediation Playbook URLs (Azure Logic Apps or Azure Functions)
# These are HTTP endpoints that perform recovery actions

# ADF Playbooks
PLAYBOOK_RETRY_PIPELINE=https://your-logic-app.azure.com/workflows/.../triggers/manual/paths/invoke
PLAYBOOK_RERUN_UPSTREAM=https://your-logic-app.azure.com/workflows/.../triggers/manual/paths/invoke

# Databricks Playbooks
PLAYBOOK_RESTART_CLUSTER=https://your-logic-app.azure.com/workflows/.../triggers/manual/paths/invoke
PLAYBOOK_RETRY_JOB=https://your-logic-app.azure.com/workflows/.../triggers/manual/paths/invoke
PLAYBOOK_REINSTALL_LIBRARIES=https://your-logic-app.azure.com/workflows/.../triggers/manual/paths/invoke
PLAYBOOK_SCALE_CLUSTER=https://your-logic-app.azure.com/workflows/.../triggers/manual/paths/invoke
PLAYBOOK_CHECK_PERMISSIONS=https://your-logic-app.azure.com/workflows/.../triggers/manual/paths/invoke

# Auto-Remediation Limits
AUTO_REMEDIATION_MAX_RETRIES=3  # Max retry attempts per error
AUTO_REMEDIATION_MAX_COST_USD=100  # Max daily cost for auto-remediation (future use)

# -----------------------------------------------------------------------------
# Optional: Application Settings
# -----------------------------------------------------------------------------
PUBLIC_BASE_URL=http://localhost:8000
