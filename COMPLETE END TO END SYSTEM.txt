â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          COMPLETE END-TO-END SYSTEM FLOW                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE 1: ERROR DETECTION & ALERT ROUTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[AZURE DATA FACTORY] Pipeline Execution
    â†“ (fails)
[AZURE MONITOR] Alert Triggered
    â†“
[LOGIC APP] Receives Alert
    â”œâ”€> Extracts: PipelineName, PipelineRunId, ErrorMessage
    â”œâ”€> CHECK: GET /api/check-ticket-exists/{run_id} â—„â”€â”€â”€â”€â”€â”
    â”‚   â”œâ”€ Database Query: SELECT * FROM tickets WHERE run_id=? â”‚
    â”‚   â””â”€ Response: {"exists": true/false}                     â”‚
    â”œâ”€> Decision:                                               â”‚
    â”‚   - If exists=true: STOP (no duplicate)                  â”‚
    â”‚   - If exists=false: Continue                            â”‚
    â””â”€> POST /azure-monitor â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   FASTAPI BACKEND â”‚ (main.py)
        â”‚   Port 8000       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â†“                                     â†“
    [DATABRICKS] Job/Cluster Fails       [ALTERNATIVE PATH]
                â”‚
                â†“
    [DATABRICKS WEBHOOK]
        - Event Delivery or Standard format
        - Contains: job_name, run_id, error_message
                â”‚
                â”œâ”€> [DATABRICKS API ENRICHMENT]
                â”‚   GET /api/2.1/jobs/runs/get?run_id=xxx
                â”‚   GET /api/2.1/jobs/runs/get-output?run_id=xxx
                â”‚   â””â”€> Extract detailed error from task outputs
                â”‚
                â””â”€> POST /databricks-monitor â”€â”€â”€â”€â”€â”€â”€â”
                                                     â”‚
                                                     â†“

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE 2: RCA PROCESSING (Backend: main.py)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ azure_monitor() or databricks_monitor() function                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1. PARSE WEBHOOK                                                     â”‚ â”‚
â”‚ â”‚    â”œâ”€ Extract: pipeline, run_id, error_message                       â”‚ â”‚
â”‚ â”‚    â””â”€ Clean: Remove "Forwarded to RCA" text                          â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 2. DEDUPLICATION CHECK (Backend-side)                                â”‚ â”‚
â”‚ â”‚    SELECT id FROM tickets WHERE run_id = ?                           â”‚ â”‚
â”‚ â”‚    â”œâ”€ If EXISTS: Return 200 "duplicate_ignored" â†’ END                â”‚ â”‚
â”‚ â”‚    â””â”€ If NOT: Continue                                               â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 3. FINOPS TAG EXTRACTION                                             â”‚ â”‚
â”‚ â”‚    extract_finops_tags(pipeline_name, resource_type)                 â”‚ â”‚
â”‚ â”‚    â””â”€ Keyword matching: financeâ†’Finance, dataâ†’DataEngineering       â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 4. AI RCA GENERATION                                                 â”‚ â”‚
â”‚ â”‚    generate_rca_and_recs(error_message, source_type)                 â”‚ â”‚
â”‚ â”‚    â”œâ”€ call_ai_for_rca() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚ â”‚
â”‚ â”‚    â”‚                                           â†“                      â”‚ â”‚
â”‚ â”‚    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   GEMINI AI (Google Cloud)             â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   Model: gemini-2.5-flash              â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚ Prompt:                                â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚ - Service context (ADF/Databricks)     â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚ - Error types taxonomy                 â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚ - Severity/Priority guidelines         â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚ - JSON response schema                 â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚ Response:                              â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚ {                                      â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   "root_cause": "...",                 â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   "error_type": "...",                 â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   "affected_entity": "...",            â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   "severity": "Critical/High/...",     â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   "priority": "P1/P2/P3/P4",           â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   "confidence": "Very High/High/...",  â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   "recommendations": [...],            â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚   "auto_heal_possible": true/false     â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â”‚ }                                      â”‚              â”‚ â”‚
â”‚ â”‚    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚
â”‚ â”‚    â”‚                           â†“                                      â”‚ â”‚
â”‚ â”‚    â””â”€ If success: Use AI response                                    â”‚ â”‚
â”‚ â”‚    â””â”€ If failure: fallback_rca() â†’ Generic response                  â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 5. SLA CALCULATION                                                   â”‚ â”‚
â”‚ â”‚    Priority â†’ SLA mapping:                                           â”‚ â”‚
â”‚ â”‚    P1:900s(15m), P2:1800s(30m), P3:7200s(2h), P4:86400s(24h)        â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 6. TICKET CREATION                                                   â”‚ â”‚
â”‚ â”‚    ticket_id = "ADF-20250126T143522-abc123" or "DBX-..."            â”‚ â”‚
â”‚ â”‚    INSERT INTO tickets (id, timestamp, pipeline, run_id, ...)       â”‚ â”‚
â”‚ â”‚    â”œâ”€ If UNIQUE constraint: Return "duplicate_race_condition" â†’ END â”‚ â”‚
â”‚ â”‚    â””â”€ If success: Continue                                           â”‚ â”‚
â”‚ â”‚    INSERT INTO audit_trail (action="Ticket Created", ...)            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â†“                                   â†“                              â†“

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE 3: EXTERNAL INTEGRATIONS (Parallel async operations)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AZURE BLOB STORAGE    â”‚    â”‚   JIRA INTEGRATION       â”‚    â”‚   SLACK NOTIFICATION   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ upload_payload_to_blob()â”‚    â”‚ create_jira_ticket()     â”‚    â”‚ post_slack_notif()     â”‚
â”‚ â”œâ”€ Blob name:           â”‚    â”‚ â”œâ”€ Auth: Basic          â”‚    â”‚ â”œâ”€ Constructs blocks:  â”‚
â”‚ â”‚  YYYY-MM-DD/          â”‚    â”‚ â”‚  (email:token)         â”‚    â”‚ â”‚  - Header: Alert     â”‚
â”‚ â”‚  ticket-payload.json  â”‚    â”‚ â”œâ”€ Endpoint:             â”‚    â”‚ â”‚  - Metadata          â”‚
â”‚ â”œâ”€ Uploads JSON:        â”‚    â”‚ â”‚  /rest/api/3/issue     â”‚    â”‚ â”‚  - Root Cause        â”‚
â”‚ â”‚  Complete webhook     â”‚    â”‚ â”œâ”€ Payload:              â”‚    â”‚ â”‚  - Recommendations   â”‚
â”‚ â”‚  body                 â”‚    â”‚ â”‚  project, summary,     â”‚    â”‚ â”‚  - Button: Dashboard â”‚
â”‚ â”œâ”€ Returns: blob_url    â”‚    â”‚ â”‚  description (ADF doc),â”‚    â”‚ â”œâ”€ POST to Slack API  â”‚
â”‚ â”œâ”€ UPDATE tickets SET   â”‚    â”‚ â”‚  issuetype             â”‚    â”‚ â”‚  /chat.postMessage   â”‚
â”‚ â”‚  blob_log_url=?       â”‚    â”‚ â””â”€ Returns: Jira key    â”‚    â”‚ â”œâ”€ Returns: ts, channelâ”‚
â”‚ â””â”€ Audit: "Blob Saved"  â”‚    â”‚    (e.g., "PROJ-123")   â”‚    â”‚ â”œâ”€ UPDATE tickets SET  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ UPDATE tickets SET      â”‚    â”‚ â”‚  slack_ts, channel    â”‚
                               â”‚  itsm_ticket_id=key     â”‚    â”‚ â””â”€ Audit: "Slack Sent" â”‚
                               â”‚ Audit: "Jira Created"   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE 4: REAL-TIME UPDATES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WEBSOCKET BROADCAST                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ manager.broadcast({"event": "new_ticket", "ticket_id": "..."})â”‚
â”‚ â”œâ”€ Iterates: active_connections list                           â”‚
â”‚ â”œâ”€ Sends JSON to all connected dashboard clients              â”‚
â”‚ â””â”€ Clients receive â†’ refreshAll() â†’ UI updates                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â†“                                        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ DASHBOARD CLIENT 1  â”‚              â”‚ DASHBOARD CLIENT 2       â”‚
    â”‚ (Browser A)         â”‚              â”‚ (Browser B)              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ ws.onmessage:       â”‚              â”‚ ws.onmessage:            â”‚
    â”‚ â”œâ”€ Parse event      â”‚              â”‚ â”œâ”€ Parse event           â”‚
    â”‚ â””â”€ refreshAll()     â”‚              â”‚ â””â”€ refreshAll()          â”‚
    â”‚    â”œâ”€ fetchOpen()   â”‚              â”‚    â”œâ”€ fetchOpen()        â”‚
    â”‚    â”œâ”€ fetchInProg() â”‚              â”‚    â”œâ”€ fetchInProg()      â”‚
    â”‚    â”œâ”€ fetchClosed() â”‚              â”‚    â”œâ”€ fetchClosed()      â”‚
    â”‚    â””â”€ render()      â”‚              â”‚    â””â”€ render()           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE 5: DATABASE STORAGE (SQLite/Azure SQL)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DATABASE SCHEMA (tickets.db or Azure SQL)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ TABLE: tickets                                                       â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ - id (PK): "ADF-20250126T143522-abc123"                             â”‚  â”‚
â”‚  â”‚ - timestamp: "2025-01-26T14:35:22.123456+00:00"                     â”‚  â”‚
â”‚  â”‚ - pipeline: "DataIngestion_Pipeline"                                â”‚  â”‚
â”‚  â”‚ - run_id: "abc-123-def-456" [UNIQUE INDEX, nullable]                â”‚  â”‚
â”‚  â”‚ - rca_result: "Blob not found at specified path..."                 â”‚  â”‚
â”‚  â”‚ - recommendations: JSON array                                        â”‚  â”‚
â”‚  â”‚ - confidence: "High"                                                 â”‚  â”‚
â”‚  â”‚ - severity: "Critical"                                               â”‚  â”‚
â”‚  â”‚ - priority: "P1"                                                     â”‚  â”‚
â”‚  â”‚ - error_type: "UserErrorSourceBlobNotExists"                        â”‚  â”‚
â”‚  â”‚ - affected_entity: "container/path/file.csv"                        â”‚  â”‚
â”‚  â”‚ - status: "open" | "in_progress" | "acknowledged"                   â”‚  â”‚
â”‚  â”‚ - ack_user, ack_empid, ack_ts, ack_seconds                          â”‚  â”‚
â”‚  â”‚ - sla_seconds: 900, sla_status: "Met" | "Breached" | "Pending"     â”‚  â”‚
â”‚  â”‚ - slack_ts, slack_channel                                           â”‚  â”‚
â”‚  â”‚ - finops_team, finops_owner, finops_cost_center                     â”‚  â”‚
â”‚  â”‚ - blob_log_url: Azure Blob URL                                      â”‚  â”‚
â”‚  â”‚ - itsm_ticket_id: "PROJ-123" (Jira key)                             â”‚  â”‚
â”‚  â”‚ - logic_app_run_id: Logic App execution ID                          â”‚  â”‚
â”‚  â”‚ - processing_mode: "Single" | "Parallel" | "databricks"            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ TABLE: audit_trail                                                   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ - id (PK, AUTOINCREMENT)                                             â”‚  â”‚
â”‚  â”‚ - timestamp                                                          â”‚  â”‚
â”‚  â”‚ - ticket_id (FK to tickets.id)                                       â”‚  â”‚
â”‚  â”‚ - pipeline, run_id                                                   â”‚  â”‚
â”‚  â”‚ - action: "Ticket Created", "Ticket Closed", "Jira: Done", etc.     â”‚  â”‚
â”‚  â”‚ - user_name, user_empid                                              â”‚  â”‚
â”‚  â”‚ - time_taken_seconds, mttr_minutes                                   â”‚  â”‚
â”‚  â”‚ - sla_status: "Met" | "Breached"                                     â”‚  â”‚
â”‚  â”‚ - rca_summary: First 200 chars of root cause                         â”‚  â”‚
â”‚  â”‚ - finops_team, finops_owner                                          â”‚  â”‚
â”‚  â”‚ - details: Additional context                                        â”‚  â”‚
â”‚  â”‚ - itsm_ticket_id: "PROJ-123"                                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ TABLE: users                                                         â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ - id (PK, AUTOINCREMENT)                                             â”‚  â”‚
â”‚  â”‚ - email (UNIQUE): user@sigmoidanalytics.com                          â”‚  â”‚
â”‚  â”‚ - password_hash: bcrypt hash                                         â”‚  â”‚
â”‚  â”‚ - full_name                                                          â”‚  â”‚
â”‚  â”‚ - created_at, last_login                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE 6: DASHBOARD DISPLAY & USER INTERACTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DASHBOARD (dashboard.html) - User View                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. PAGE LOAD                                                              â”‚
â”‚     â”œâ”€ checkAuth() â†’ Validates localStorage.getItem('authToken')           â”‚
â”‚     â”œâ”€ If no token â†’ Redirect /login                                       â”‚
â”‚     â”œâ”€ loadUserInfo() â†’ GET /api/me â†’ Display email                        â”‚
â”‚     â”œâ”€ fetchConfig() â†’ GET /api/config â†’ Load ITSM settings                â”‚
â”‚     â””â”€ refreshAll() â†’ Fetch all ticket data                                â”‚
â”‚                                                                             â”‚
â”‚  2. TICKET TABS (Open / In Progress / Closed)                              â”‚
â”‚     â”œâ”€ switchTab('open') â†’ Shows openTickets                               â”‚
â”‚     â”œâ”€ switchTab('in_progress') â†’ Shows inProgressTickets                  â”‚
â”‚     â””â”€ switchTab('closed') â†’ Shows closedTickets                           â”‚
â”‚                                                                             â”‚
â”‚  3. TICKET CARDS (for each ticket)                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚     â”‚ â”‚ DataIngestion_Pipeline          [High] [P2]                 â”‚   â”‚  â”‚
â”‚     â”‚ â”‚ ADF-20250126T143522-abc123                                  â”‚   â”‚  â”‚
â”‚     â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚  â”‚
â”‚     â”‚ â”‚ Blob not found at container/path/file.csv...                â”‚   â”‚  â”‚
â”‚     â”‚ â”‚ Run: abc-123-def-456    2025-01-26 14:35:22                â”‚   â”‚  â”‚
â”‚     â”‚ â”‚ [Jira: PROJ-123] ðŸ·ï¸ DataEngineering ðŸ‘¤ datateam@...       â”‚   â”‚  â”‚
â”‚     â”‚ â”‚ â±ï¸ SLA 28m 14s left                                         â”‚   â”‚  â”‚
â”‚     â”‚ â”‚ [View Details]                                              â”‚   â”‚  â”‚
â”‚     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚  4. SLA TIMER (updates every 1 second)                                     â”‚
â”‚     - Green: > 2 minutes remaining                                         â”‚
â”‚     - Yellow: < 2 minutes remaining                                        â”‚
â”‚     - Red: SLA breached                                                    â”‚
â”‚                                                                             â”‚
â”‚  5. SEARCH & FILTER                                                        â”‚
â”‚     - Search box filters by: ticket_id, pipeline, rca, itsm_id             â”‚
â”‚     - Real-time filtering as user types                                    â”‚
â”‚                                                                             â”‚
â”‚  6. MODAL DETAIL VIEW                                                      â”‚
â”‚     Click "View Details" â†’ openModal(ticket_id)                            â”‚
â”‚     â”œâ”€ GET /api/tickets/{id} â†’ Full ticket data                            â”‚
â”‚     â”œâ”€ Shows:                                                              â”‚
â”‚     â”‚  - Complete RCA text                                                 â”‚
â”‚     â”‚  - All recommendations                                               â”‚
â”‚     â”‚  - Error type, Affected entity                                       â”‚
â”‚     â”‚  - FinOps tags (team, owner, cost center)                            â”‚
â”‚     â”‚  - Clickable Jira link                                               â”‚
â”‚     â”‚  - If closed: Ack user, timestamp, MTTR                              â”‚
â”‚     â””â”€ READ-ONLY (no action buttons, just "Close")                         â”‚
â”‚                                                                             â”‚
â”‚  7. AUDIT TRAIL TAB                                                        â”‚
â”‚     - Table with all actions: Ticket Created, Closed, Jira updates         â”‚
â”‚     - Color-coded action badges                                            â”‚
â”‚     - Filter by action type                                                â”‚
â”‚     - Real-time search across all columns                                  â”‚
â”‚     - Stats cards: Open, Closed, MTTR, SLA Breached, Total Audits         â”‚
â”‚                                                                             â”‚
â”‚  8. CSV EXPORT                                                             â”‚
â”‚     - "Download CSV" button per tab                                        â”‚
â”‚     - Downloads filtered/current view only                                 â”‚
â”‚                                                                             â”‚
â”‚  9. WEBSOCKET UPDATES                                                      â”‚
â”‚     - Connected to ws://host/ws                                            â”‚
â”‚     - Receives: {"event": "new_ticket", ...}                               â”‚
â”‚     - Auto-refreshes: refreshAll() â†’ render()                              â”‚
â”‚     - Fallback: Poll every 15 seconds                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PHASE 7: JIRA BI-DIRECTIONAL SYNC
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JIRA â†’ AIOPS SYNC (Webhook)                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  User updates ticket status in Jira UI (e.g., "In Progress" â†’ "Done")      â”‚
â”‚     â†“                                                                       â”‚
â”‚  Jira sends webhook â†’ POST /webhook/jira?secret=xxx                        â”‚
â”‚     â”œâ”€ Event: "jira:issue_updated"                                         â”‚
â”‚     â”œâ”€ Payload: issue.key, changelog.items[]                               â”‚
â”‚     â””â”€ New status: "Done"                                                  â”‚
â”‚     â†“                                                                       â”‚
â”‚  Backend: webhook_jira()                                                   â”‚
â”‚     â”œâ”€ Validates secret                                                    â”‚
â”‚     â”œâ”€ Extracts: jira_key, new_status_name                                 â”‚
â”‚     â”œâ”€ DB: SELECT * FROM tickets WHERE itsm_ticket_id = "PROJ-123"         â”‚
â”‚     â”œâ”€ Log audit: "Jira: Done"                                             â”‚
â”‚     â”œâ”€ Status mapping:                                                     â”‚
â”‚     â”‚  - "done"/"resolved"/"closed" â†’ local="acknowledged"                 â”‚
â”‚     â”‚  - "in progress"/"in review" â†’ local="in_progress"                   â”‚
â”‚     â”‚  - Others â†’ local="open"                                             â”‚
â”‚     â””â”€ If closing ticket:                                                  â”‚
â”‚        perform_close_from_jira()                                           â”‚
â”‚        â”œâ”€ Calculates: time_taken, mttr, sla_status                         â”‚
â”‚        â”œâ”€ UPDATE tickets SET status='acknowledged', ack_user='Jira User'   â”‚
â”‚        â”œâ”€ Log audit: "Ticket Closed"                                       â”‚
â”‚        â”œâ”€ update_slack_message_on_ack()                                    â”‚
â”‚        â”‚  â””â”€ POST slack.com/api/chat.update â†’ Updates original message    â”‚
â”‚        â””â”€ manager.broadcast() â†’ Dashboard updates in real-time            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SUMMARY: DATA FLOW PATHS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. ERROR â†’ BACKEND â†’ DATABASE â†’ DASHBOARD
   ADF/Databricks Error â†’ FastAPI â†’ SQLite/Azure SQL â†’ WebSocket â†’ Browser

2. BACKEND â†’ JIRA â†’ BACKEND â†’ DASHBOARD
   Ticket Created â†’ Jira API â†’ Jira Ticket Created â†’ (Later) Jira Status Change â†’ 
   Webhook â†’ FastAPI â†’ Database Update â†’ WebSocket â†’ Dashboard Refresh

3. BACKEND â†’ SLACK â†’ (User) â†’ BACKEND
   Ticket Created â†’ Slack Notification â†’ User Sees Alert â†’ (Later) Status Change â†’ 
   Slack Message Updated

4. DASHBOARD â†’ BACKEND â†’ DATABASE â†’ DASHBOARD
   User Views â†’ GET API â†’ Query Database â†’ Return JSON â†’ Render UI

5. AI FLOW
   Error Text â†’ Gemini API â†’ Structured RCA â†’ Database â†’ Dashboard Display

6. AUDIT FLOW
   Every Action â†’ audit_trail table â†’ Audit Trail Tab â†’ CSV Export

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
KEY TECHNOLOGIES & THEIR ROLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Backend:
- FastAPI: REST API server (async Python)
- SQLAlchemy: Database ORM
- PyODBC: Azure SQL driver
- Pydantic: Data validation
- JWT: Authentication tokens
- Bcrypt: Password hashing
- WebSockets: Real-time updates

Frontend:
- Vanilla JavaScript: No frameworks
- WebSocket API: Real-time connection
- Fetch API: HTTP requests with Bearer auth
- LocalStorage: Token persistence
- DOM manipulation: Dynamic rendering

AI/ML:
- Google Gemini AI: RCA generation
- Model: gemini-2.5-flash
- Structured JSON output

Integrations:
- Slack API: chat.postMessage, chat.update
- Jira REST API: /rest/api/3/issue
- Databricks Jobs API: /api/2.1/jobs/runs/get
- Azure Blob Storage: Payload archival

Database:
- SQLite: Local development
- Azure SQL: Production (with failover to SQLite)
- Tables: tickets, audit_trail, users
- Unique constraints: Deduplication

Security:
- API Key auth: x-api-key header for webhooks
- JWT Bearer: Authorization header for dashboard
- Email domain restriction: @sigmoidanalytics.com only
- Webhook secret: Jira webhook validation
